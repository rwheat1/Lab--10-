---
title: "Lab 10 - Grading the professor, Pt. 2"
author: "Insert your name here"
date: "Insert date here"
output: github_document
---

### Load packages and data

```{r load-packages, message=FALSE}
library(tidyverse) 
library(tidymodels)
library(openintro)
```

### Exercise 1

A one unit increase in a professor's beauty rating leads to a .06 unit increase in their course evaluations. R2 = 3.5%; Adjusted R2 = 3.3%.

```{r model-one}

m_bty <- linear_reg() %>%
  set_engine ("lm") %>%
  fit(score ~ bty_avg, data = evals)

tidy(m_bty)

glance(m_bty)$r.squared
glance(m_bty)$adj.r.squared

```


### Exercise 2

score = bty_avg(.074) + gender(.172)

R2 = 5.9%
Adjusted R2 = 5.5%

```{r model-two}

m_bty_gen <- linear_reg() %>%
  set_engine("lm") %>%
  fit(score ~ bty_avg + gender, data = evals)

tidy(m_bty_gen)

glance(m_bty_gen)$r.squared
glance(m_bty_gen)$adj.r.squared

```


### Exercise 3

b1: Holding gender constant, a one unit increase in a professor's beauty rating predicts a .07 unit increase in their course evaluations. 

b2: Holding beauty constant, male professors tend to receive course evaluations that are .17 points higher than female professors.

Intercept: A female professor with a beauty rating of 0 will receive a 3.74 rating in their course evals.


### Exercise 4

5.5% of the total variance in course evaluation scores is explained by the professor's beauty and gender.

### Exercise 5

Equation for the Line for Male Professors:
y = 3.91 + .07(bty_avg)

### Exercise 6

Holding beauty constant, male professors tend to have higher course evaluations than female professors.

### Exercise 7

The relationship between beauty and course evaluations is stronger for male professors than female professors, over and above beauty and gender themselves as predictors. In other words, when a professor is male, beauty matters more for determining their course evaluations.

```{r interaction}

#create an interaction term

evals <- evals %>%
  mutate(bty_mcentered = bty_avg - mean(bty_avg))

m_bty_gen_int <- linear_reg() %>%
  set_engine("lm") %>%
  fit(score ~ bty_avg + gender + bty_mcentered*gender, data = evals)

tidy(m_bty_gen_int)
```


### Exercise 8

The r-squared values are larger when considering gender (R2 = .055) in addition to beauty, rather than beauty as the sole predictor of course evaluations (R2 = .032). This suggests that there is unique variance explained by gender above and beyond what is explained by beauty.

### Exercise 9

m_bty: b = .066
m_bty_gen: b = .074

Adding gender as a predictor has increased the slope of beauty as a predictor of course evaluations.

### Exercise 10

y = bty_avg(.064) + rank_ten(-.04)

In order to interpret rank as a predictor, I turned that variable into a from three categorical options (tenured, tenure track, and teaching) to a dichotomous categorical variable: tenured professors, vs. non-tenured professors.

Holding rank constant, a one point increase in a professor's beauty score leads to a .064 increase in their course evaluations.

Holding beauty constant, there is no significant effect of tenure on course evaluations.

```{r rank}

evals <- evals %>%
  mutate(rank_ten = case_when(rank == "tenure track" ~ "non-tenured", rank == "teaching" ~ "non-tenured", rank == "tenured" ~ "tenured"))

m_bty_rank <- linear_reg() %>%
  set_engine("lm") %>%
  fit(score ~ bty_avg + rank_ten, data = evals)

tidy(m_bty_rank)
```


